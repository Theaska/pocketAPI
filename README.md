# pocketAPI

Простой REST сервис (на Django).
Используемые технологии:
* Django (для создания веб-приложения)
* Django Rest Framework (для создания REST api)
* JWT (для аутентификации пользователей)
* Swagger (для документации и удобной работы с API)
* Postgres (для хранения всей информации о пользователях, кошельках, транзакциях)
* Redis (для хранения кодов подтверждения удаления кошельков/активирования транзакций)
* Docker и docker-compose (для развертывания приложения)

Сервис по управлению финансами, функционал следующий:
- Пользователь хранит данные о своем "кошельке", произвольное название + баланс в рублях.
- В рамках кошелька ведется история транзакций (как списание, так и пополнение).
- Кошельков может быть больше чем 1, но сам пользователь один (это его персональный веб сервис).

API сервиса должен позволять:
1. создавать, редактировать и удалять кошелек.
2. создавать и удалять транзакции в рамках кошелька (при этом напрямую редактировать баланс кошелька пользователь не может)
транзакции могут быть как +, так и -. то есть транзакции по зачислению денег и списанию.
у каждой транзакции должна быть дата, сумма, произвольный комментарий от пользователя.
3. Просматривать список своих кошельков
4. Просматривать список своих транзакций как в рамках одного кошелька, так и общий, всех кошельков сразу.

## Как развертывать приложение
1. перейти в папку pocketAPI
2. выполнить команду ` docker-compose up --build `
3. перейти на http://localhost/, на котором отобразиться swagger ui.

## Как работать с API
1. Создать пользователя http://localhost/accounts/signup/
2. На введенную пользователем почту/в консоль придет сообщение с ссылкой в виде http://example.com/accounts/confirm-email/<token>
3. Для подтверждения почты нужно перейти по ссылке, заменив example.com на http://localhost/accounts/confirm-email/<token> или ввести токен в UI сваггера.
4. Получить access token http://localhost/accounts/login/, введя логин и пароль.
5. Теперь для работы со всем функционалом API, передавать в header - Access-Token:<access_token> или нажать на кнопку authorize в swagger-ui и ввести полученный access-token.
6. Если срок действия access токена истек, можно обновить его, используя refresh token, полученный на этапе авторизации, передав его его в http://localhost/tokens/update-tokens/ или используя swagger-ui.

Все остальные действия, которые можно совершить при работе с ui описаны в swagger.
Есть несколько моментов, которые нужно уточнить:
1. При удалении кошелька, они не удаляются, а архивируются. При "удалении" нужно ввести код подтверждения. Код подтверждения можно получить передав запрос по урлу: http://localhost/pocket/{pocket-uuid}/send-deletion-code/. Код придет на почту, указанную при регистрации (или в консоль).
2. После создания транзакции, ее нужно подтвердить, передав код подтверждения по http://localhost/transactions/{transaction-uuid}/confirm-transaction/. Код придет на почту, после отправки запроса на http://localhost/transactions/{transaction-uuid}/send-confirm-code/.

## Пути улучшения
1. Для отправки сообщений использовать Celery или RabbitMQ.
2. Отправлять коды подтверждения при отмене/удалении транзакции.
3. Создать урлы для смены пароля аккаунтов.
4. Использование разных валют (рубли, доллары, евро).
